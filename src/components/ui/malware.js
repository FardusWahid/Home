// lib/redis.js
import { Redis } from "@upstash/redis";
import { cache } from 'react';

// Create Redis instance
export const redis = new Redis({
  url: "https://picked-polecat-27842.upstash.io",
  token: "AWzCAAIjcDE2ZDc4MWVkMTg1ODQ0NTc3YmU0Zjk0MTYzZDFkMmYwZXAxMA",
  // Add cache options
  automaticDeserialization: true,
});

// Create cached getter
export const getCachedData = cache(async (key) => {
  try {
    const data = await redis.get(key);
    return data;
  } catch (error) {
    console.error('Redis fetch error:', error);
    return null;
  }
});

// Helper for static data fetching
export async function prefetchData(key) {
  try {
    const data = await redis.get(key);
    return data;
  } catch (error) {
    console.error('Prefetch error:', error);
    return null;
  }
}